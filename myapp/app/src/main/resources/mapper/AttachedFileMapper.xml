<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="AttachedFileDao">

  <insert id="add" parameterType="bitcamp.myapp.vo.AttachedFile">
    insert into boards(title,content,writer,category)
    values(#{title},#{content},#{writer},#{category})
  </insert>

  <delete id="delete" parameterType="int">
    delete from boards where board_no=#{no}
  </delete>

  <select id="findAll" resultType="bitcamp.myapp.vo.AttachedFile" parameterType="int">
    select
      b.board_no as no,
      b.title,
      b.created_date as createdDate,
      count(file_no) as fileCount,
      m.member_no,
      m.name
    from
      boards b left outer join board_files bf on b.board_no=bf.board_no
      inner join members m on b.writer=m.member_no
    where
      b.category=#{value}
    group by
      board_no
    order by
      board_no desc
  </select>

  <select id="findBy" resultType="bitcamp.myapp.vo.AttachedFile" parameterType="int">
    select
      b.board_no as no,
      b.title,
      b.conten
      b.created_date as createdDate,
      m.member_no,
      m.name
    from
      boards b inner join members m on b.writer=m.member_no
    where board_no=#{value}
  </select>

  <update id="update" parameterType="bitcamp.myapp.vo.AttachedFile">
    update boards set title=#{title}, content=#{content}
    where board_no=#{no}
  </update>
</mapper>